\subsection{NeutrinoCrossSections}

This object can be query to obtain neutrino cross section information used when considering neutrino non-coherent interactions. The {\ttf NeutrinoCrossSections} is a base abstract class, which the user has to subclass and implement the relevant neutrino cross section for the problem at hand. The user must specify the total cross section per flavor and per interaction type (charge and neutral current), as well as the single differential cross sections with respect to the outgoing neutrino energy.

\subsubsection{NeutrinoCrossSections}

First, we define enumerations to lable flavor, neutrino, and interaction type.
\begin{itemize}
  \item {\ttf NeutrinoFlavor}
  \begin{lstlisting}
    enum NeutrinoFlavor {electron = 0, muon = 1, tau = 2, sterile = 3};
  \end{lstlisting}
  Enumeration that is used to specify the neutrino flavor.
  \item {\ttf NeutrinoType}
  \begin{lstlisting}
    enum NeutrinoType {neutrino = 0, antineutrino = 1};
  \end{lstlisting}
  Enumeration used to specify {\ttf neutrino} and {\ttf antineutrino} particle type.
  \item {\ttf Current}
  \begin{lstlisting}
    enum Current {CC, NC, GR};
  \end{lstlisting}
  Enumeration used to specify charged ({\ttf CC}), neutral ({\ttf NC}) current interactions, 
  and Glashow resonant interactions ({\ttf GR}).
\end{itemize}

Second we list the public abstract virtual functions.

\begin{itemize}
  \item Total cross section
  \begin{lstlisting}
    virtual double TotalCrossSection(double Enu,
    	NeutrinoFlavor flavor, NeutrinoType neutype,
    	Current current) const;
  \end{lstlisting}
  Abstract virtual function that given a neutrino energy ({\ttf Enu})
  in eV, neutrino flavor ({\ttf flavor}, neutrino type ({\ttf
    neutype}), and interaction type ({\ttf current}) returns the 
  total cross section in ${\rm cm}^2$.
  \item Single differential cross section
  \begin{lstlisting}
    virtual double SingleDifferentialCrossSection(double E1, double E2,
    	NeutrinoFlavor flavor, NeutrinoType neutype,
    	Current current) const;
  \end{lstlisting}
  Abstract virtual function that given an incident neutrino energy
  ({\ttf E1}) in eV, outgoing neutrino energy ({\ttf E2}) in eV,
  neutrino flavor ({\ttf flavor}, neutrino type ({\ttf neutype}), and
  interaction type ({\ttf current}) returns the differential cross
  section with respect to the outgoing neutrino energy in ${\rm
    cm}^2{\rm GeV}^{-1}$.  
  \item Double differential cross section
  \begin{lstlisting}
    virtual double DoubleDifferentialCrossSection(double E, 
        double x, double y,
    	NeutrinoFlavor flavor, NeutrinoType neutype,
    	Current current) const;
  \end{lstlisting}
  Virtual function such that given the neutrino energy ({\ttf E}),
  Bjorken-x ({\ttf x}), and y ({\ttf y}) should to return the double
   differential cross section. Its implementation is no required to
   run {\ttf nuSQUIDS} and by default when evaluated, unless
   overwritten, it will throw an error. 
\end{itemize}

\subsubsection{NeutrinoDISCrossSectionsFromTables}

This class uses precalculated deep inelastic cross section tables
which are provided by {\ttf nuSQuIDS}.
In the code two different cross-sections are available:
{\ttf csms.h5} is a perturbative QCD next-to-leading order calculation using the HERA
parton distributions functions~\cite{Chekanov:2002pv} on an iso-scalar
target~\cite{CooperSarkar:2011pa}. {\ttf nusigma}~\cite{nusigma} is a first order QCD
calculation using the {\ttf CTEQ6} parton distribution functions on an
iso-scalar target. In the {\ttf csms} calculation the mass of the tau
is neglected thus the neutrinos cross section is the same for all
flavors; this is not the case for the {\ttf nusigma} calculation.
Both correspond to deep inelastic scattering which is the dominant
neutrino interaction with nucleons above $O({\rm 10~GeV})$. 

The cross sections are loaded from tables included in
{\ttfamily nuSQUIDS/data/xsections/}.
The cross section object can be constructed from a single {\ttf hdf5}
file that contains both single and total cross sections or by a set of
four text files. The four text files have to end with the suffixes
{\ttf dsde\_CC.dat}, {\ttf dsde\_NC.dat}, {\ttf sigma\_CC.dat}, and
{\ttf sigma\_NC.dat}.
The text files contain the following columns:
For the total cross-sections neutrino energy in GeV, electron neutrino 
cross sections, electron anti-neutrino cross-section, muon neutrino
cross sections, muon anti-neutrino cross-section, tau neutrino
cross sections, and tau anti-neutrino cross-section. All the cross
section values are in cm$^2$.
For the single differential cross-sections incident neutrino energy in
GeV, outgoing neutrino energy in GeV, electron neutrino 
differential cross sections, differential electron anti-neutrino cross-section, muon neutrino
differential cross sections, muon anti-neutrino differential cross-section, tau neutrino
differential cross sections, and tau anti-neutrino differential
cross-section. All the differential cross-section values are in cm$^2$GeV$^{-1}$.


\begin{lstlisting}
  NeutrinoDISCrossSectionsFromTables x(``./csms.h5'')
  NeutrinoDISCrossSectionsFromTables x(``./nusigma_'')
\end{lstlisting}


\subsubsection{Constructors}

\begin{itemize}
\item Standard void constructor.
  \begin{lstlisting}
    NeutrinoDISCrossSectionsFromTables();
  \end{lstlisting}
This constructor calculate and store the cross sections on
logarithmically spaced energy nodes between {\ttfamily Emin} and
{\ttfamily Emax} with {\ttfamily Esize} divisions. For the total cross
section {\ttfamily gsl\_spline} \citep{gough2009gnu} is used to
interpolate in neutrino energy, where as for the differential cross
section simple bilinear interpolation has been implemented. 
\end{itemize}

\subsubsection{Functions}

\begin{itemize}
\item Total cross sections
  \begin{lstlisting}
    double TotalCrossSection(double Enu,
    	NeutrinoFlavor flavor, NeutrinoType neutype,
    	Current current) const;
  \end{lstlisting}
     Returns the total cross section at an energy {\ttf Enu}, neutrino flavor {\ttf flavor}, neutrino type: {\ttf neutype}, and
     {\ttf current} can be either {\ttf NC} or {\ttf CC} for neutral or charge current DIS cross sections.        
\item Single differential cross sections              
  \begin{lstlisting}
    double SingleDifferentialCrossSection(double E1, double E2,
    	NeutrinoFlavor flavor, NeutrinoType neutype,
    	Current current) const;
  \end{lstlisting}
      Function that given an incident neutrino energy ({\ttf E1}) in GeV an outgoing lepton energy ({\ttf E2}), as well as neutrino flavor,
       type, and process, returns the differential cross section with respect to the outgoing lepton energy in ${\rm cm}^2 {\rm GeV}^{-1}$. 
       In order to calculate the cross section from the table linear interpolation in log of the parameters is used.
\end{itemize}

\subsubsection{GlashowResonanceCrossSection}

This class implements the formulas in \citep{GhandiReno} in order to calculate the electron antineutrino Glashow resonance cross section contribution.

\subsubsection{Constructors}

\begin{itemize}
\item Standard void constructor.
  \begin{lstlisting}
    GlashowResonanceCrossSection();
  \end{lstlisting}
\end{itemize}

\subsubsection{Functions}

\begin{itemize}
\item Total cross sections
  \begin{lstlisting}
    double TotalCrossSection(double Enu,
    	NeutrinoFlavor flavor, NeutrinoType neutype,
    	Current current) const;
  \end{lstlisting}
     Returns the total cross section at an energy {\ttf Enu}, neutrino flavor {\ttf flavor}, and neutrino type: {\ttf neutype}.
     If the flavor is not electron and neutrino type is not antineutrino it returns zero.              
\item Single differential cross sections
  \begin{lstlisting}
    double SingleDifferentialCrossSection(double E1, double E2,
    	NeutrinoFlavor flavor, NeutrinoType neutype,
    	Current current) const;
  \end{lstlisting}
  Returns the single differential cross section at an energy {\ttf Enu}, neutrino flavor {\ttf flavor}, 
  and neutrino type: {\ttf neutype}.
     If the flavor is not electron and neutrino type is not antineutrino it returns zero.   
      
\end{itemize}

\subsection{TauDecaySpectra}

This object can be query to obtain $\tau$ decay physics into leptons and hadrons. The formulas implemented in this class were taken from \citep{Dutta:2000jv} and are implemented in natural units. It is only used when $\tau$-regeneration is activated and it returns the following quantities on the energy nodes
\begin{equation}
\frac{dN^{lep/had}_{dec} (E_\tau, E_\nu)}{dE_\nu} , \frac{d\bar{N}^{lep/had}_{dec} (E_\tau, E_\nu)}{dE_\nu} 
\label{eqn:tau-dist}
\end{equation}
i.e. the neutrino and antineutrino spectral distributions from $\tau$ leptonic and hadronic decay modes.

\subsubsection{Constructors and Initializing Functions}

\begin{itemize}
\item Standard void constructor.
  \begin{lstlisting}
    TauDecaySpectra();
  \end{lstlisting}
\item Constructor and initializing function with memory reservation.
  \begin{lstlisting}
    TauDecaySpectra(marray<double,1> E\_range);
    void Init(marray<double,1> E\_range);
  \end{lstlisting}
This constructor and initialization functions calculate and store the $\tau$ decay spectra on nodes specified by the one dimensional array {\ttf E\_range}.
\end{itemize}

\subsubsection{Functions}

The following functions assume that the $\tau$ and $\bar{\tau}$ have the same decay distribution.

\begin{itemize}
\item (Anti)Neutrino spectra with respect to neutrino energy
  \begin{lstlisting}
    double dNdEnu_All(int e1,int e2) const;
  \end{lstlisting}
  Returns neutrino decay spectra evaluated between energy nodes  {\ttfamily e1} and {\ttfamily e2} when $\tau$ decays into leptons or hadrons.
  \begin{lstlisting}
    double dNdEnu_Lep(int e1,int e2) const;
  \end{lstlisting}
  Returns neutrino decay spectra evaluated between energy nodes  {\ttfamily e1} and {\ttfamily e2} when $\tau$ decays into leptons.
\item (Anti)Neutrino spectra with respect to $\tau$ energy
  \begin{lstlisting}
    double dNdEle_All(int e1,int e2) const;
  \end{lstlisting}
    Returns neutrino decay spectra evaluated between energy nodes  {\ttfamily e1} and {\ttfamily e2} when $\tau$ decays into leptons or hadrons. with
    respect to the initial $\tau$ energy.
  \begin{lstlisting}
    double dNdEle_Lep(int e1,int e2) const;
  \end{lstlisting}
     Returns neutrino decay spectra evaluated between energy nodes  {\ttfamily e1} and {\ttfamily e2} when $\tau$ decays into leptons. with
    respect to the initial $\tau$ energy.
\item Get the $\tau$ branching ratio to leptons
  \begin{lstlisting}
    double GetTauToLeptonBranchingRatio() const;
  \end{lstlisting}
    Returns the $\tau$ branching ratio to leptons.
\item Get the $\tau$ branching ratio to hadrons
  \begin{lstlisting}
    double GetTauToHadronBranchingRatio() const;
  \end{lstlisting}
    Returns the $\tau$ branching ratio to hadrons.
\end{itemize}
